{
    "openapi": "3.0.3",
    "info": {
        "title": "API de Gestion RH",
        "description": "API Laravel pour la gestion des ressources humaines avec authentification Sanctum",
        "version": "1.0.0",
        "contact": {
            "name": "Support API",
            "email": "dev@example.com"
        }
    },
    "servers": [
        {
            "url": "http://localhost:8000/api/v1",
            "description": "Serveur de développement"
        },
        {
            "url": "https://personal-management.onrender.com/api/v1",
            "description": "Serveur de production" 
        }
    ],
    "security": [
        {
            "bearerAuth": []
        }
    ],
    "components": {
        "securitySchemes": {
            "bearerAuth": {
                "type": "http",
                "scheme": "bearer",
                "bearerFormat": "JWT",
                "description": "Token d'authentification Sanctum"
            }
        },
        "schemas": {
            "User": {
                "type": "object",
                "properties": {
                    "id": { "type": "integer" },
                    "name": { "type": "string" },
                    "email": { "type": "string" },
                    "role_id": { "type": "integer" },
                    "statut": {
                        "type": "string",
                        "enum": ["attente_attribution", "actif", "inactif"]
                    },
                    "firstConnexion": { "type": "string" },
                    "email_verified_at": {
                        "type": "string",
                        "format": "date-time"
                    },
                    "created_at": { "type": "string", "format": "date-time" },
                    "updated_at": { "type": "string", "format": "date-time" }
                }
            },
            "Employe": {
                "type": "object",
                "properties": {
                    "id": { "type": "integer" },
                    "nom": { "type": "string" },
                    "prenom": { "type": "string" },
                    "email": { "type": "string" },
                    "adresse": { "type": "string" },
                    "date_naiss": { "type": "string", "format": "date" },
                    "lieu_naiss": { "type": "string", "format": "date" },
                    "situation_matrimoniale": { "type": "string" },
                    "date_prise_service": {
                        "type": "string",
                        "format": "date"
                    },
                    "genre": { "type": "string" },
                    "type_contrat": { "type": "string" },
                    "solde_conge_jours": { "type": "integer" },
                    "fonction_id": { "type": "integer" },
                    "service_id": { "type": "integer" },
                    "type_agent_id": { "type": "integer" },
                    "user_id": { "type": "integer" },
                    "created_at": { "type": "string", "format": "date-time" },
                    "updated_at": { "type": "string", "format": "date-time" }
                }
            },
            "Conge": {
                "type": "object",
                "properties": {
                    "id": { "type": "integer" },
                    "employe_id": { "type": "integer" },
                    "type_conge_id": { "type": "integer" },
                    "date_demande": { "type": "string", "format": "date" },
                    "date_debut": { "type": "string", "format": "date" },
                    "date_fin": { "type": "string", "format": "date" },
                    "nombre_jours": { "type": "integer" },
                    "statut": {
                        "type": "string",
                        "enum": ["en_attente", "approuve", "refuse"]
                    },
                    "commentaire": { "type": "string" },
                    "piece_jointe": { "type": "file" },
                    "note_pdf": { "type": "string" },
                    "created_at": { "type": "string", "format": "date-time" },
                    "updated_at": { "type": "string", "format": "date-time" }
                }
            },
            "Cessation": {
                "type": "object",
                "properties": {
                    "id": { "type": "integer" },
                    "employe_id": { "type": "integer" },
                    "type_conge_id": { "type": "integer" },
                    "date_debut": { "type": "string", "format": "date" },
                    "date_fin": { "type": "string", "format": "date" },
                    "statut": {
                        "type": "string",
                        "enum": ["en_attente", "approuve", "refuse"]
                    },
                    "commentaire": { "type": "string" },
                    "fiche_cessation_pdf": { "type": "file" },
                    "nombre_jours": { "type": "integer" },
                    "created_at": { "type": "string", "format": "date-time" },
                    "updated_at": { "type": "string", "format": "date-time" }
                }
            },
            "Disponibilite": {
                "type": "object",
                "properties": {
                    "id": { "type": "integer" },
                    "employe_id": { "type": "integer" },
                    "date_demande": { "type": "string", "format": "date" },
                    "date_debut": { "type": "string", "format": "date" },
                    "date_fin": { "type": "string", "format": "date" },
                    "nombre_jours": { "type": "integer" },
                    "avec_solde": { "type": "boolean" },
                    "statut": {
                        "type": "string",
                        "enum": ["en_attente", "approuve", "refuse"]
                    },
                    "motif": { "type": "string" },
                    "piece_jointe": { "type": "file" },
                    "fiche_disponibilite_pdf": { "type": "file" },
                    "commentaire": { "type": "string" },
                    "created_at": { "type": "string", "format": "date-time" },
                    "updated_at": { "type": "string", "format": "date-time" }
                }
            },
            "TypeConge": {
                "type": "object",
                "properties": {
                    "id": { "type": "integer" },
                    "libelle": { "type": "string" },
                    "jours_par_defaut": { "type": "integer" },
                    "created_at": { "type": "string", "format": "date-time" },
                    "updated_at": { "type": "string", "format": "date-time" }
                }
            },

            "ApiResponse": {
                "type": "object",
                "properties": {
                    "success": { "type": "boolean" },
                    "message": { "type": "string" },
                    "data": { "type": "object" }
                }
            },
            "ErrorResponse": {
                "type": "object",
                "properties": {
                    "success": { "type": "boolean", "example": false },
                    "message": { "type": "string" },
                    "errors": { "type": "object" }
                }
            }
        }
    },
    "tags": [
        {
            "name": "Authentication",
            "description": "Endpoints pour l'authentification"
        },
        {
            "name": "Permissions",
            "description": "Gestion des permissions et rôles"
        },
        {
            "name": "Users",
            "description": "Gestion des utilisateurs"
        },
        {
            "name": "Employés",
            "description": "Gestion des employés"
        },
        {
            "name": "Congés",
            "description": "Gestion des congés"
        },
        {
            "name": "Cessations",
            "description": "Gestion des cessations"
        },
        {
            "name": "Disponibilités",
            "description": "Gestion des disponibilités"
        },
        {
            "name": "Types de Congés",
            "description": "Gestion des types de congés"
        },
        {
            "name": "Statistiques",
            "description": "Statistiques de l'application"
        }
    ],

    "paths": {
        "/permissions/roles-permissions": {
            "get": {
                "tags": ["Permissions"],
                "summary": "Récupérer les rôles et permissions",
                "description": "Récupère la liste des rôles et permissions disponibles",
                "security": [],
                "responses": {
                    "200": {
                        "description": "Liste des rôles et permissions récupérée avec succès",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "success": {
                                            "type": "boolean",
                                            "example": true
                                        },
                                        "data": {
                                            "type": "array",
                                            "items": {
                                                "$ref": "#/components/schemas/Cessation"
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        },
        "/auth/login": {
            "post": {
                "tags": ["Authentication"],
                "summary": "Connexion utilisateur",
                "description": "Authentifie un utilisateur et retourne un token Sanctum",
                "security": [],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "required": ["email", "password"],
                                "properties": {
                                    "email": {
                                        "type": "string",
                                        "format": "email",
                                        "example": "rh1@gmail.com"
                                    },
                                    "password": {
                                        "type": "string",
                                        "example": "password123"
                                    }
                                }
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Connexion réussie",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "success": {
                                            "type": "boolean",
                                            "example": true
                                        },
                                        "token": { "type": "string" },
                                        "user": {
                                            "$ref": "#/components/schemas/User"
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Identifiants invalides",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ErrorResponse"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/auth/logout": {
            "post": {
                "tags": ["Authentication"],
                "summary": "Déconnexion utilisateur",
                "description": "Déconnecte l'utilisateur et révoque le token",
                "responses": {
                    "200": {
                        "description": "Déconnexion réussie",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ApiResponse"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Non authentifié",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ErrorResponse"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/auth/connectedUser": {
            "get": {
                "tags": ["Authentication"],
                "summary": "Utilisateur connecté",
                "description": "Récupère les informations de l'utilisateur connecté",
                "responses": {
                    "200": {
                        "description": "Informations utilisateur récupérées",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "success": {
                                            "type": "boolean",
                                            "example": true
                                        },
                                        "user": {
                                            "$ref": "#/components/schemas/User"
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Non authentifié",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ErrorResponse"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/users/all": {
            "get": {
                "tags": ["Users"],
                "summary": "Liste tous les utilisateurs",
                "description": "Récupère la liste de tous les utilisateurs",
                "responses": {
                    "200": {
                        "description": "Liste des utilisateurs récupérée",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "success": {
                                            "type": "boolean",
                                            "example": true
                                        },
                                        "data": {
                                            "type": "array",
                                            "items": {
                                                "$ref": "#/components/schemas/User"
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        },
        "/users/create-employe-account": {
            "post": {
                "tags": ["Users"],
                "summary": "Créer un compte pour un employé",
                "description": "Crée un compte utilisateur pour un employé existant",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "required": ["role_id", "employe_id"],
                                "properties": {
                                    "employe_id": { "type": "integer" },
                                    "role_id": { "type": "integer" }
                                }
                            }
                        }
                    }
                },
                "responses": {
                    "201": {
                        "description": "Compte créé avec succès",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ApiResponse"
                                }
                            }
                        }
                    },
                    "422": {
                        "description": "Erreurs de validation",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ErrorResponse"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/users/{id}": {
            "get": {
                "tags": ["Users"],
                "summary": "Afficher un utilisateur",
                "description": "Récupère les détails d'un utilisateur spécifique",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "required": true,
                        "schema": { "type": "integer" },
                        "description": "ID de l'utilisateur"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Utilisateur trouvé",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "success": {
                                            "type": "boolean",
                                            "example": true
                                        },
                                        "data": {
                                            "$ref": "#/components/schemas/User"
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Utilisateur non trouvé"
                    }
                }
            },
            "put": {
                "tags": ["Users"],
                "summary": "Mettre à jour un utilisateur",
                "description": "Met à jour les informations d'un utilisateur",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "required": true,
                        "schema": { "type": "integer" },
                        "description": "ID de l'utilisateur"
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "properties": {
                                    "name": { "type": "string" },
                                    "email": {
                                        "type": "string",
                                        "format": "email"
                                    }
                                }
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Utilisateur mis à jour",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ApiResponse"
                                }
                            }
                        }
                    }
                }
            },
            "delete": {
                "tags": ["Users"],
                "summary": "Supprimer un utilisateur",
                "description": "Supprime un utilisateur",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "required": true,
                        "schema": { "type": "integer" },
                        "description": "ID de l'utilisateur"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Utilisateur supprimé",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ApiResponse"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/users/change-password": {
            "post": {
                "tags": ["Users"],
                "summary": "Changer le mot de passe",
                "description": "Change le mot de passe de l'utilisateur connecté",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "required": ["password", "confirmed"],
                                "properties": {
                                    "password": { "type": "string" },
                                    "confirmed": { "type": "string" }
                                }
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Mot de passe changé avec succès",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ApiResponse"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/employes": {},
        "/employes/soldeConge": {},
        "/employes/{id}": {},
        "/employes/dossiers/{id}": {},
        "/conges": {},
        "/conges/mesConges": {},
        "/conges/{id}": {},
        "/conges/traiterDemandeConge/{id}": {},
        "/cessations": {},
        "/cessations/mesCessations": {},
        "/cessations/{id}": {},
        "/cessations/traiterDemandeCessation/{id}": {},
        "/disponibilites": {},
        "/disponibilites/mesDisponibilites": {},
        "/disponibilites/{id}": {},
        "/disponibilites/traiterDemandeCessation/{id}": {},
        "/typesConges": {},
        "/typesConges/{id}": {},
        "/stats": {},
        "/stats/{entity}": {}
    }
}
